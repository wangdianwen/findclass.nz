---
title: Story - Teacher Module
category: integration-test
created: 2026-01-26
author: linus-torvalds
version: 1.0
status: draft
module: teacher
filename: story-teacher.md
---

# Story - 教师模块集成测试

> **模块**: teacher | **测试类型**: integration | **路径**: `tests/integration/teacher/`

> **测试原则**: 集成测试(20%) 验证端到端用户流程，单元测试(80%) 覆盖所有API逻辑

---

## US10: 教师入驻申请

### 用户故事

```
作为 已注册用户
我希望 申请成为平台教师
以便 发布我的课程并提供服务
```

### 测试用例

#### Happy Path

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 个人教师正常申请 | 用户已注册，非教师 | 提交完整申请信息 | 申请创建成功，状态pending |
| TC02-HP | 机构代表申请 | 用户已注册，非教师 | 选择机构类型，提交信息 | 申请创建成功，状态pending |
| TC03-HP | 资深教师申请 | 用户已注册，非教师 | 选择资深类型，提交资质 | 申请创建成功，信任等级S |
| TC04-HP | 查看申请状态 | 已有进行中申请 | 查询申请状态 | 返回正确的状态信息 |
| TC05-HP | 查看申请详情 | 已有申请 | 查询申请详情 | 返回完整申请信息 |
| TC06-HP | 管理员审核通过 | 申请待审核 | 审核通过操作 | 申请状态变approved，创建教师档案 |
| TC07-HP | 管理员审核拒绝 | 申请待审核 | 审核拒绝操作 | 申请状态变rejected，发送邮件 |
| TC08-HP | 审核需要补充材料 | 申请待审核 | 标记需要补充 | 申请状态变revision_required |
| TC09-HP | 补充材料后重新提交 | 申请需补充 | 更新申请并提交 | 申请重新进入pending |
| TC10-HP | 审核通过后发布课程 | 已是认证教师 | 发布课程 | 课程发布成功 |

#### Failed Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 重复申请 | 有进行中申请 | 再次提交申请 | 提示已有进行中申请 |
| TC02-FC | 已是教师再次申请 | 已是认证教师 | 提交申请 | 提示已是认证教师 |
| TC03-FC | 无效邮箱格式 | 无 | 提交邮箱格式错误 | 提示邮箱格式无效 |
| TC04-FC | 缺少必填字段 | 无 | 提交不完整申请 | 提示缺少必填字段 |
| TC05-FC | 越权查看他人申请 | 其他用户有申请 | 查询他人申请详情 | 返回403禁止访问 |
| TC06-FC | 越权更新他人申请 | 其他用户有申请 | 更新他人申请 | 返回403禁止访问 |
| TC07-FC | 非管理员审核 | 普通用户 | 执行审核操作 | 返回403禁止访问 |
| TC08-FC | 审核已完成申请 | 申请已通过 | 再次审核 | 提示申请状态不可审核 |
| TC09-FC | 上传无效文件 | 申请待补充 | 上传非PDF/JPG文件 | 提示文件类型不支持 |
| TC10-FC | 文件大小超限 | 申请待补充 | 上传超大文件 | 提示文件大小超限 |

#### Edge Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 极端长文本 | 无 | 输入超长自我介绍 | 自动截断或拒绝 |
| TC02-EC | 特殊字符姓名 | 无 | 输入带特殊字符姓名 | 正确处理并保存 |
| TC03-EC | 多语言教学语言 | 无 | 选择多种教学语言 | 正确保存多语言 |
| TC04-EC | 多年教学经验 | 无 | 输入10年以上经验 | 正确识别并保存 |
| TC05-EC | 多个资质证书 | 无 | 上传多个资质文件 | 全部保存成功 |
| TC06-EC | 申请超时处理 | 申请pending超过48h | 查询申请状态 | 状态仍为pending或自动处理 |
| TC07-EC | 并发审核同一申请 | 两个管理员同时审核 | 同时审核 | 只有一个成功，另一个提示已处理 |
| TC08-EC | 敏感内容过滤 | 无 | 输入含敏感词描述 | 提示或自动过滤 |
| TC09-EC | 机构营业执照过期 | 选择机构类型 | 提交过期执照 | 提示执照已过期 |
| TC10-EC | 网络中断恢复 | 上传文件中断 | 重新上传 | 文件上传成功 |

---

## US11: 教师个人主页

### 用户故事

```
作为 教师
我希望 管理我的个人主页
以便 展示我的教学特色和成果
```

### 测试用例

#### Happy Path

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 查看个人主页 | 已是教师 | 访问个人主页 | 显示公开信息 |
| TC02-HP | 更新个人简介 | 已是教师 | 修改bio | bio更新成功 |
| TC03-HP | 更新教学成果 | 已是教师 | 修改achievements | 更新成功 |
| TC04-HP | 上传头像 | 已是教师 | 上传新头像 | 头像更新成功 |
| TC05-HP | 更新教学语言 | 已是教师 | 修改教学语言 | 更新成功 |
| TC06-HP | 更新所在城市 | 已是教师 | 修改城市 | 更新成功 |

#### Failed Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 非教师访问 | 非教师 | 访问教师主页API | 返回403或404 |
| TC02-FC | 上传非法格式头像 | 已是教师 | 上传非图片文件 | 提示格式不支持 |
| TC03-FC | 头像过大 | 已是教师 | 上传超大图片 | 提示文件过大 |
| TC04-FC | bio超过限制 | 已是教师 | 输入超长bio | 提示超出限制 |

#### Edge Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 特殊字符处理 | 已是教师 | 输入emoji/特殊字符 | 正确保存和显示 |
| TC02-EC | 并发更新 | 已是教师 | 多个请求同时更新 | 最终一致 |
| TC03-EC | 敏感内容 | 已是教师 | 输入敏感词bio | 自动过滤或拒绝 |

---

## US12: 教师回复评价

### 用户故事

```
作为 教师
我希望 回复学生/家长的评价
以便 与用户互动并展示教学态度
```

### 测试用例

#### Happy Path

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 正常回复评价 | 有待回复评价 | 发布回复 | 回复成功，显示在评价下 |
| TC02-HP | 回复已删除评价 | 评价已删除 | 尝试回复 | 提示评价不存在 |
| TC03-HP | 多次回复 | 已回复过 | 再次回复 | 回复成功（可多次回复） |

#### Failed Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 回复他人课程评价 | 不是该课程教师 | 尝试回复 | 提示无权限 |
| TC02-FC | 空回复 | 有评价 | 发送空内容 | 提示内容不能为空 |
| TC03-FC | 回复过长 | 有评价 | 输入超长回复 | 提示超出限制 |

#### Edge Cases

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 敏感词回复 | 有评价 | 含敏感词回复 | 自动过滤或拒绝 |
| TC02-EC | 并发回复 | 有评价 | 多个教师同时回复 | 全部成功 |
| TC03-EC | 表情符号回复 | 有评价 | 仅表情符号 | 允许或拒绝（根据策略） |

---

## 测试数据

```typescript
// 测试数据
const testTeachers = [
  {
    id: 'teacher-001',
    userId: 'user-001',
    name: '张老师',
    bio: '专注高中数学教学10年',
    city: 'Auckland',
    teachingLanguages: ['chinese', 'english'],
    trustLevel: 'A',
    status: 'active',
  },
  {
    id: 'teacher-002',
    userId: 'user-002',
    name: '李老师',
    bio: '钢琴专业教学',
    city: 'Wellington',
    teachingLanguages: ['chinese'],
    trustLevel: 'S',
    status: 'active',
  },
];

const testApplications = [
  {
    id: 'app-001',
    userId: 'user-001',
    applicationType: 'individual',
    status: 'pending',
    realName: '张老师',
    city: 'Auckland',
  },
];
```

---

## 相关文档

| 文档 | 路径 |
|------|------|
| 教师入驻技术架构 | ../teacher/tech-teacher-onboarding.md |
| 教师个人主页技术架构 | ../teacher/tech-personal-teacher.md |
| 教师回复技术架构 | ../teacher/tech-teacher-replies.md |
| 教师入驻产品设计 | ../../05-product-design/teacher/teacher-onboarding.md |

---

**文档路径**: `/Users/dianwenwang/Project/idea/06-tech-architecture/teacher/teacher-stories.md`
