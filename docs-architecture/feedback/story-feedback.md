---
title: Story - Feedback Module
category: integration-test
created: 2026-01-26
author: linus-torvalds
version: 1.0
status: draft
module: feedback
filename: story-feedback.md
---

# Story - 反馈模块集成测试

> **模块**: feedback | **测试类型**: integration | **路径**: `tests/integration/feedback/`

> **测试原则**: 集成测试(20%) 验证端到端用户流程，单元测试(80%) 覆盖所有API逻辑

---

## US32: 用户反馈

### 用户故事

```
作为 平台用户
我希望 提交使用反馈和问题报告
以便 帮助平台改进体验
```

### 测试用例

#### Happy Path - 反馈提交流程

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 提交问题反馈 | 用户已登录 | 选择类型→填写内容→提交 | 反馈创建成功 |
| TC02-HP | 提交功能建议 | 用户已登录 | 选择类型→填写建议 | 反馈创建成功 |
| TC03-HP | 提交投诉 | 用户已登录 | 选择类型→填写详情 | 反馈创建成功，标记投诉 |
| TC04-HP | 添加反馈截图 | 用户已填写反馈 | 上传图片 | 截图上传成功 |
| TC05-HP | 查看我的反馈 | 已有反馈 | 查询列表 | 返回反馈列表 |
| TC06-HP | 查看反馈详情 | 已有反馈 | 查询详情 | 返回完整反馈 |
| TC07-HP | 反馈处理状态更新 | 管理员已处理 | 查看状态 | 显示已处理状态 |
| TC08-HP | 评价反馈处理 | 用户已收到回复 | 评价处理 | 评价提交成功 |

#### Failed Cases - 反馈失败场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 未登录提交反馈 | 用户未登录 | 提交 | 引导登录 |
| TC02-FC | 反馈内容为空 | - | 提交空白 | 提示内容不能为空 |
| TC03-FC | 反馈内容过短 | - | 输入1个字 | 提示内容过短 |
| TC04-FC | 反馈内容过长 | - | 输入超长内容 | 提示超出限制 |
| TC05-FC | 无效反馈类型 | - | 选择不支持类型 | 提示类型无效 |
| TC06-FC | 上传无效图片 | - | 上传非图片 | 提示格式不支持 |
| TC07-FC | 上传超大图片 | - | 上传超大图片 | 提示文件过大 |
| TC08-FC | 查看他人反馈 | 非本人反馈 | 查看 | 返回403 |
| TC09-FC | 评价已删除反馈 | 反馈已删除 | 评价 | 提示反馈不存在 |

#### Edge Cases - 边界场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 敏感词反馈 | 含敏感词 | 提交 | 自动过滤或拒绝 |
| TC02-EC | 大量图片上传 | 一次上传10张 | 上传 | 正确处理或提示限制 |
| TC03-EC | 特殊字符内容 | 含emoji/特殊符号 | 提交 | 正确保存显示 |
| TC04-EC | 并发提交反馈 | 多个用户 | 同时提交 | 全部成功 |
| TC05-EC | 反馈列表分页 | 有50+反馈 | 分页查询 | 正确分页 |
| TC06-EC | 反馈搜索 | 有大量反馈 | 按关键词搜索 | 返回匹配结果 |
| TC07-EC | 反馈时效性 | 反馈后查看 | 检查时间 | 显示正确时间 |
| TC08-EC | 网络中断恢复 | 提交中断 | 重新提交 | 反馈创建成功 |

---

## US33: 问题追踪

### 用户故事

```
作为 平台管理员
我希望 追踪和管理用户反馈
以便 及时响应和解决问题
```

### 测试用例

#### Happy Path - 问题追踪流程

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 查看待处理反馈 | 管理员已登录 | 查询待处理 | 返回待处理列表 |
| TC02-HP | 查看反馈详情 | 管理员已登录 | 查询详情 | 返回完整信息 |
| TC03-HP | 分配反馈处理 | 管理员已登录 | 分配给自己 | 分配成功 |
| TC04-HP | 更新处理状态 | 管理员已登录 | 标记处理中 | 状态更新成功 |
| TC05-HP | 回复用户反馈 | 管理员已登录 | 发送回复 | 回复发送成功 |
| TC06-HP | 标记反馈已解决 | 管理员已登录 | 标记解决 | 反馈变已解决 |
| TC07-HP | 删除无效反馈 | 管理员已登录 | 删除 | 删除成功 |
| TC08-HP | 批量处理反馈 | 管理员已登录 | 批量分配 | 批量处理成功 |
| TC09-HP | 查看处理统计 | 管理员已登录 | 查看统计 | 返回统计数据 |
| TC10-HP | 反馈分类 | 管理员已登录 | 重新分类 | 分类更新成功 |

#### Failed Cases - 问题追踪失败场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 无权限查看反馈 | 普通用户 | 查看 | 返回403 |
| TC02-FC | 处理已删除反馈 | 反馈已删除 | 处理 | 返回404 |
| TC03-FC | 重复分配 | 已分配给A | B分配 | 提示已分配 |
| TC04-FC | 回复空内容 | - | 发送空回复 | 提示内容不能为空 |
| TC05-FC | 越权回复他人分配 | 反馈分配给A | B回复 | 提示无权限 |
| TC06-FC | 批量处理超限 | - | 一次处理100条 | 提示数量限制 |
| TC07-FC | 关闭已关闭反馈 | 反馈已关闭 | 再次关闭 | 提示已关闭 |

#### Edge Cases - 边界场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 并发处理同一反馈 | 两个管理员 | 同时处理 | 一个成功，一个提示 |
| TC02-EC | 大量待处理反馈 | 有1000+待处理 | 分页查看 | 正确分页 |
| TC03-EC | 反馈优先级排序 | 多个反馈 | 按优先级查看 | 正确排序 |
| TC04-EC | 投诉自动升级 | 投诉超过X小时未处理 | 检查状态 | 自动升级 |
| TC05-EC | 回复模板 | 常用回复 | 使用模板 | 快速回复 |
| TC06-EC | 处理时效统计 | 查看统计 | 计算平均处理时间 | 返回统计数据 |
| TC07-EC | 敏感内容处理 | 含敏感信息 | 回复 | 自动脱敏或标记 |

---

## US34: 用户满意度调查

### 用户故事

```
作为 平台用户
我希望 参与满意度调查
以便 反馈对平台整体体验的评价
```

### 测试用例

#### Happy Path - 调查流程

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-HP | 查看调查问卷 | 有进行中调查 | 打开问卷 | 显示问卷内容 |
| TC02-HP | 提交问卷 | 用户已填写 | 提交问卷 | 提交成功 |
| TC03-HP | 查看我的提交 | 已提交 | 查询提交 | 显示提交记录 |
| TC04-HP | 查看调查结果 | 调查已结束 | 查看统计 | 显示统计结果 |

#### Failed Cases - 调查失败场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-FC | 提交不存在的问卷 | - | 提交 | 返回404 |
| TC02-FC | 重复提交问卷 | 已提交 | 再次提交 | 提示已提交 |
| TC03-FC | 必答题未答 | 有未答题 | 提交 | 提示需完成所有必答 |
| TC04-FC | 问卷已过期 | 调查已结束 | 提交 | 提示已结束 |

#### Edge Cases - 边界场景

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|----------|
| TC01-EC | 部分答题提交 | 允许部分回答 | 提交 | 按规则处理 |
| TC02-EC | 调查匿名性 | 用户提交 | 检查关联 | 匿名统计 |
| TC03-EC | 问卷分页 | 问卷内容多 | 翻页答题 | 正确保存进度 |
| TC04-EC | 网络中断恢复 | 提交中断 | 重新提交 | 问卷创建成功 |

---

## 测试数据

```typescript
// 测试数据
const testFeedbacks = [
  {
    id: 'feedback-001',
    userId: 'user-001',
    type: 'problem',
    category: 'payment',
    title: '支付问题',
    content: '我无法完成支付',
    status: 'pending',
    attachments: ['screenshot1.jpg'],
    createdAt: '2026-01-26T10:00:00Z',
  },
  {
    id: 'feedback-002',
    userId: 'user-002',
    type: 'suggestion',
    category: 'feature',
    title: '希望增加课程提醒',
    content: '希望能增加课程开始前的提醒功能',
    status: 'resolved',
    resolution: '功能已加入开发计划',
    createdAt: '2026-01-25T10:00:00Z',
  },
];

const testSurveys = [
  {
    id: 'survey-001',
    title: '平台满意度调查',
    status: 'active',
    questions: [
      { id: 'q1', text: '您对平台整体满意度如何？', type: 'rating', required: true },
      { id: 'q2', text: '您有什么建议？', type: 'text', required: false },
    ],
    endsAt: '2026-02-28T23:59:59Z',
  },
];
```

---

## 相关文档

| 文档 | 路径 |
|------|------|
| 用户反馈技术架构 | ../feedback/tech-feedback.md |
| 用户反馈产品设计 | ../../05-product-design/feedback/user-feedback.md |

---

**文档路径**: `/Users/dianwenwang/Project/idea/06-tech-architecture/feedback/feedback-stories.md`
