# Internationalization

## Using Translations

```typescript
import { useTranslation } from 'react-i18next';

// Load namespace
const { t } = useTranslation('search');

// Use translation key (no prefix!)
t('course.perLesson'); // ✅
t('search:course.perLesson'); // Also works

// ❌ Wrong - prefix when namespace specified
const { t } = useTranslation('about');
t('about.hero.title'); // 'about.' is redundant!
```

## Namespace Configuration

| Namespace | File                     | Usage         |
| --------- | ------------------------ | ------------- |
| home      | `locales/en/home.json`   | Home page     |
| search    | `locales/en/search.json` | Course search |
| about     | `locales/en/about.json`  | About page    |
| common    | `locales/en/common.json` | Shared texts  |

## Adding New Keys

```json
// locales/en/search.json
{
  "course.perLesson": "lesson",
  "course.totalLessons": "{{count, number}} lessons"
}
```

```json
// locales/zh/search.json
{
  "course.perLesson": "节",
  "course.totalLessons": "共{{count, number}}节"
}
```

## Common Mistakes

### 1. Namespace Prefix in Key

```typescript
// ❌ Wrong
const { t } = useTranslation('home');
t('home.nav.home');

// ✅ Correct
const { t } = useTranslation('home');
t('nav.home');
```

### 2. Missing Namespace Registration

Ensure namespace is registered in `src/locales/i18n.ts`:

```typescript
i18n.init({
  ns: ['home', 'search', 'about', 'common', ...],
});
```

### 3. Not Loading Namespace

```typescript
// ❌ Wrong - namespace not loaded
const { t } = useTranslation('search');
t('key');  // May fail

// ✅ Correct - parameters.i18n.loadNamespaces
parameters: {
  i18n: { locale: 'en', loadNamespaces: ['search'] },
},
```

## i18n in Storybook

```typescript
parameters: {
  i18n: {
    locale: 'en',
    loadNamespaces: ['search'],
  },
},
```

## Pluralization

```json
{
  "resultsCount": "{{count}} courses found",
  "resultsCount_one": "{{count}} course found",
  "resultsCount_other": "{{count}} courses found"
}
```

## Interpolation

```json
{
  "totalLessons": "{{count, number}} lessons"
}
```

```typescript
t('totalLessons', { count: 10 });
// Output: "10 lessons"
```

## Forbidden

| Forbidden                        | Reason                                             |
| -------------------------------- | -------------------------------------------------- |
| Key with namespace prefix        | `about.title` when using `useTranslation('about')` |
| Missing namespace in init        | Namespace not registered                           |
| No `loadNamespaces` in Storybook | Translations won't load                            |

## Troubleshooting

| Error                        | Cause                            | Solution                   |
| ---------------------------- | -------------------------------- | -------------------------- |
| `i18n2.on is not a function` | storybook-react-i18next conflict | Use manual I18nextProvider |
| Translation not working      | Namespace not registered         | Add to ns array in i18n.ts |
| `key 'xxx' not found`        | Missing key in JSON              | Check translation file     |
| Language switch not updating | No re-render triggered           | Use i18n.changeLanguage()  |

## File Structure

```
src/locales/
├── en/
│   ├── home.json
│   ├── search.json
│   ├── about.json
│   └── common.json
└── zh/
    ├── home.json
    ├── search.json
    ├── about.json
    └── common.json
```
